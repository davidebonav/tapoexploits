from zlib import crc32

def extract_UDP_key(udp_packet):
    shared_secret = 0
    while shared_secret:
        tmp = bytearray(udp_packet)
        tmp[12:16] = shared_secret.to_bytes(4, 'big') 
        checksum = crc32(tmp).to_bytes(4, 'big')

        print(bytes(checksum))
        print(udp_packet[12:16])
        
        if bytes(checksum) == udp_packet[12:16]: 
            break
        else:
            print("Trying: ", shared_secret.to_bytes(4, 'big'))
            shared_secret += 1

    print(b"Shared secret founded: " + shared_secret.to_bytes(4, 'big'))
    return shared_secret.to_bytes(4, 'big') 

if __name__ == "__main__":
    input = 'PUT INPUT HERE'
    pkt = bytes.fromhex(input)
    extract_UDP_key(pkt)